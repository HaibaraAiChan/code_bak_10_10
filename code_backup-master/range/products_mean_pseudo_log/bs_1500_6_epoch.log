main start at this time 1630641904.79446
before load_data step Time(s): 0.0017
load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.5103
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2564
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 4.3124
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
graph after remove self connected edges
Graph(num_nodes=2449029, num_edges=123718024,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0010
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0001
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0512
-------------------------------------------------end of load ogb****************** step Time(s): 0.0038
finish constructing ogbn-products
load ogb-products time total: 6.135348320007324
#nodes: 2449029
#edges: 123718024
#classes: 47
after load_dataset step Time(s): 6.2469
after inductive else step Time(s): 0.0001
args.data_cpu
False
after label step Time(s): 4.5571
after train_g.create_formats_() step Time(s): 2.5150
after pack data step Time(s): 11.4782


full batch graph output nodes length
196571
block_to_graph.dstdata
OUTPUT_NID.tolist()
196571

list for split-------------------------------------------------------------------------------------------
196571

-------------------------batches_nid_list ----------------------------------------------------------------
132
- -- -- --- -- -- --weights_list-- -- -- ------- -- -- -----
[0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.0003611926479490871]
after generate_random_mini_batch_seeds_list
time of batches_nid_list generation : 0.11516880989074707 sec
Epoch 0 pseudo_mini_loss sum 5.1192145347595215


full batch graph output nodes length
196571
block_to_graph.dstdata
OUTPUT_NID.tolist()
196571

list for split-------------------------------------------------------------------------------------------
196571

-------------------------batches_nid_list ----------------------------------------------------------------
132
- -- -- --- -- -- --weights_list-- -- -- ------- -- -- -----
[0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.0003611926479490871]
after generate_random_mini_batch_seeds_list
time of batches_nid_list generation : 0.10943078994750977 sec
Epoch 1 pseudo_mini_loss sum 5.020173072814941


full batch graph output nodes length
196571
block_to_graph.dstdata
OUTPUT_NID.tolist()
196571

list for split-------------------------------------------------------------------------------------------
196571

-------------------------batches_nid_list ----------------------------------------------------------------
132
- -- -- --- -- -- --weights_list-- -- -- ------- -- -- -----
[0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.0003611926479490871]
after generate_random_mini_batch_seeds_list
time of batches_nid_list generation : 0.09982752799987793 sec
Epoch 2 pseudo_mini_loss sum 4.925096035003662


full batch graph output nodes length
196571
block_to_graph.dstdata
OUTPUT_NID.tolist()
196571

list for split-------------------------------------------------------------------------------------------
196571

-------------------------batches_nid_list ----------------------------------------------------------------
132
- -- -- --- -- -- --weights_list-- -- -- ------- -- -- -----
[0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.0003611926479490871]
after generate_random_mini_batch_seeds_list
time of batches_nid_list generation : 0.10938596725463867 sec
Epoch 3 pseudo_mini_loss sum 4.833389759063721


full batch graph output nodes length
196571
block_to_graph.dstdata
OUTPUT_NID.tolist()
196571

list for split-------------------------------------------------------------------------------------------
196571

-------------------------batches_nid_list ----------------------------------------------------------------
132
- -- -- --- -- -- --weights_list-- -- -- ------- -- -- -----
[0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.0003611926479490871]
after generate_random_mini_batch_seeds_list
time of batches_nid_list generation : 0.1568305492401123 sec
Epoch 4 pseudo_mini_loss sum 4.739242076873779


full batch graph output nodes length
196571
block_to_graph.dstdata
OUTPUT_NID.tolist()
196571

list for split-------------------------------------------------------------------------------------------
196571

-------------------------batches_nid_list ----------------------------------------------------------------
132
- -- -- --- -- -- --weights_list-- -- -- ------- -- -- -----
[0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.007630830590473671, 0.0003611926479490871]
after generate_random_mini_batch_seeds_list
time of batches_nid_list generation : 0.10177206993103027 sec
Epoch 5 pseudo_mini_loss sum 4.6522393226623535
Eval Acc 0.0399
train Acc 0.0402
Test Acc: 0.0335
